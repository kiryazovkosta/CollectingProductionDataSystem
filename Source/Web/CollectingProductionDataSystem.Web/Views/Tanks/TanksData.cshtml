@using CollectingProductionDataSystem.Web.ViewModels.Tank;
@model TankDataViewModel

@{
    Layout = "~/Views/Shared/_KendoLayout.cshtml";
}

<h2>Tanks Data</h2>

<div class="row">
    <div class="col-lg-4">
        @(Html.Kendo().ComboBox()
            .Name("areas")
            .Placeholder("Изберете област...")
            .HtmlAttributes(new { style = "width:300px" })
            .DataTextField("AreaName")
            .DataValueField("AreaId")
            .Filter(FilterType.Contains)
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetAreas", "Tanks");
                });
            })
        )
    </div>
    <div class="col-lg-4">
        @(Html.Kendo().ComboBox()
            .Name("parks")
            .Placeholder("Изберете парк...")
            .HtmlAttributes(new { style = "width:300px" })
            .DataTextField("ParkName")
            .DataValueField("ParkId")
            .Filter(FilterType.Contains)
            .DataSource(source =>
            {
                source.Read(read =>
                {
                    read.Action("GetParks", "Tanks").Data("filterParks");
                })
                .ServerFiltering(true);
            })
            .Enable(false)
            .AutoBind(false)
            .CascadeFrom("areas")
        )
        <script>
            function filterParks() {
                return {
                    areaId: $("#areas").val(),
                    parksFilter: $("#parks").data("kendoComboBox").input.val()
                };
            }
        </script>
    </div>

    <div class="col-lg-4">
        <button id="apply" type="button" class="btn btn-primary">Apply Filter</button>
    </div>
</div>

@Html.AntiForgeryToken()
@section scripts{
    <script src="~/Scripts/custom/sendAntiForgery.js"></script>
    <script>
        kendo.culture("@System.Threading.Thread.CurrentThread.CurrentCulture.Name");

        $(document).ready(function () {
            var areas = $("#areas").data("kendoComboBox"),
                parks = $("#parks").data("kendoComboBox");

            $("#apply").click(function () {
                var areaInfo = "\nArea: { id: " + areas.value() + ", name: " + areas.text() + " }",
                    parkInfo = "\nPark: { id: " + parks.value() + ", name: " + parks.text() + " }";

                alert("Details:\n" + areaInfo + parkInfo);
            });
        });
    </script>
}